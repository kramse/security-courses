\documentclass[a4paper,11pt,notitlepage]{oevelser}
% Henrik Lund Kramshøj, February 2001 
% hlk@security6.net,
% course for basic IPv6
% My standard packages
\input{sec6oevelser.tex}

\begin{document}
\selectlanguage{danish}

\newcommand{\emne}[1]{TCP/IP grundkursus}
\newcommand{\kursus}[1]{\emne{} workshop}
\newcommand{\kursusnavn}[1]{\emne\\ øvelseshæfte}

\mytitle{UNIX Audit og Administration}{øvelseshæfte}

\vskip 1 cm

\begin{center}
%\colorbox{white}{\includegraphics[width=10cm]{images/kut.jpg}}
%\colorbox{white}{\includegraphics[width=15cm]{images/network-example.pdf}}
\colorbox{white}{\includegraphics[width=10cm]{images/server-client.pdf}}


\vskip 1 cm

%\colorbox{white}{\includegraphics[width=5cm]{sleuthkit.png}}  
%\colorbox{white}{\includegraphics[width=5cm]{images/security6-logo-2.png}}  

\colorbox{white}{\includegraphics[width=8cm]{images/logo_security6net.jpg}}


%\begin{alltt}
%\tiny 
%\centerline{$Id: unix-audit-security-oevelser.tex,v 1.4 2007/07/31 10:10:19 hlk Exp $}
%\end{alltt}
\end{center}

\thispagestyle{empty}
\eject

\pagenumbering{roman}
\setlength{\parskip}{0pt}

\setcounter{tocdepth}{0}

\normal

{\color{titlecolor}\tableofcontents}
%\listoffigures - not used
%\listoftables - not used 

\normal
\pagestyle{fancyplain}
\chapter*{\color{titlecolor}Forord}
\markboth{Forord}{}
Dette kursusmateriale er beregnet til brug på kurset
\emph{\kursus}. Materialet er lavet af Henrik Lund
Kramshøj, \link{http://www.security6.net}

Materialet skal opfattes som beskrivelse af netværkssetup og
applikationer til kurser og workshops med behov for praktiske
øvelser. 

Til workshoppen hører desuden en præsentation som udleveres og der
henvises til et antal dokumenter som kan hjælpe under øvelserne.

\vskip 1cm
God fornøjelse
%\eject

\section*{\color{titlecolor}Oversigt}
\markright{Oversigt}
\setlength{\parskip}{10pt}

Materialet er inddelt i et antal områder som er beregnet til at give
valgfrihed i opsætningen af miljøet.

Formålet med kurserne at ofte at give kursusdeltagerne et indblik i
hvordan emnet i praksis ser ud og opfører sig. De foreslåede
konfigurationer ligger derfor tæt op ad virkelige konfigurationer, men
kan samtidig passes ind i et eksisterende kursusnetværk.

% beskrivelse af øvelses materialet

%Der er følgende øvelser som forventes at kunne udføres på det
%beskrevne netværk:
%\begin{itemize}
%\item IP forbindelser og sniffere
%\item SSH login - Putty og UNIX SSHD
%\item
%\end{itemize}

\section*{\color{titlecolor}Forudsætninger}

Dette materiale forudsætter at deltageren har kendskab til
TCP/IP på brugerniveau. Det betyder at begreber som
\link{www.security6.net},
\href{mailto:hlk@security6.net}{hlk@security6.net}, IP-adresse og DHCP
ikke bør være helt ukendte.   

% ordliste ikke lavet til forensics!
%Dog er der i appendix \ref{app:ordliste} lavet en ordliste der kan
%hjælpe med til at huske de vigtigste begreber som benyttes i dette
%materiale og indenfor \emne{} generelt. 

\section*{\color{titlecolor}Værktøjer}
%\markright{Værktøjer}

Materialet er beregnet på at kunne udføres i et almindeligt
kursuslokale med netværksopkoblede pc'er.

De praktiske øvelser benytter i vid udstrækning Open Source og 
kan derfor afvikles på blandt andet følgende platforme:
\begin{itemize}
\item UNIX - herunder Linux, OpenBSD, NetBSD, FreeBSD og Mac OS X
\item Microsoft Windows 2000 og XP - primært som
  klientoperativsystem
\item Kravene til kursisternes arbejdspladser er generelt en browser
  og SSH adgang
\item På visse kurser udleveres en Linux boot CD som kan benyttes til
  at skifte kursusisternes arbejdsplads til at køre Linux
\end{itemize}

Udover de programmer der gennemgås er der følgende programmer som kan
være til stor nytte:
\begin{itemize}
%\item \link{http://www.ctan.org} - \LaTeX
\item \link{http://www.openbsd.org} - OpenBSD - en moderne UNIX med
  fokus på sikkerhed
\item \link{http://www.openssh.com} - OpenSSH - Secure Shell
  værktøjer både server og klientprogrammer. Giver sikkerhed mod aflytning
\end{itemize}

% =================== body of the document ===============
% Arabic page numbers
\pagenumbering{arabic}
\rhead{\fancyplain{}{\bfseries \chaptername\ \thechapter}}

% Main chapters
%---------------------------------------------------------------------
% gennemgang af øvelserne
% check questions
% eventuelle åbne spørgsmål
% henvisning til øvelse, hvis der er en 



\chapter*{\color{titlecolor}Introduktion til netværk}
%\markboth{Introduktion til netværk}{}
\label{chap:intro}

\section*{\color{titlecolor}TCP/IP - Internet protokollerne}
Det er vigtigt at have viden om IP for at kunne implementere sikre
infrastrukturer da man ellers vil have svært ved at vælge mellem de
mange muligheder for implementation.

\section*{\color{titlecolor}OSI reference model}
En af de mest benyttede modeller til beskrivelse af netværk er OSI
reference modellen som gennemgås i alle datakommunikationsbøger.

Denne model beskriver hvorledes man kan opdele funktionerne i netværk
i lag som så kan implementeres uafhængigt og derfor kan udskiftes
nemmere - eksempelvis når der kommer nye transmissionsteknologier på
de lavere niveauer.

På billedet ses en oversigt over OSI referencemodellen, også kaldet
7-lags modellen. OSI modellen sammenlignes med internetmodellen, som
ligeledes er lagdelt.

Fordelen ved at opdele i flere lag er at man kan løse problemerne
uafhængigt og får frihed til at udskifte dele. Eksempelvis er de
nederste fysiske lag med tiden blevet hurtigere ved skift fra 10Mbit
Ethernet baseret på coax-kabler, henover 100Mbit Ethernet på
twisted-pair kabler til idag hvor Gigabit er udbredt.


\begin{figure}[H]
\label{fig:osi}
\begin{center}
\colorbox{white}{\includegraphics[width=8cm,angle=90]{images/compare-osi-ip.pdf}}
\end{center}
\caption{OSI og Internetmodellerne}
\end{figure}


\section*{\color{titlecolor}Standarder og RFC'er}
De dokumenter som beskriver internet-standarderne udgives i en række
Request for Comments (RFC'er) som kan hentes via
\link{ftp://ftp.ietf.org/rfc}. Når en standard eller et dokument i
denne serie opdateres sker det ved genudgivelse under et nyt nr - og
derved bevares de gamle versioner af alle dokumenterne. For at lette
navigeringen i disse dokumenter udgives et index-dokument som blandt
andet beskriver om et dokument er erstattet med en ny version. I
serien er også oversigter over opdelinger indenfor RFC'erne:
eksempelvis standarder (STD), For Your Information (FYI) og Best
Current Practice (BCP).

Et eksempel fra index filen er IP specifikationen (version 4):\\
0791 Internet Protocol. J. Postel. Sep-01-1981. (Format: TXT=97779
bytes) (Obsoletes RFC0760) (Updated by RFC1349) (Also STD0005)
(Status: STANDARD) 

Det betyder at \cite{RFC0791} altså er en standard og den erstatter
\cite{RFC0760}.

Hvis man så kigger på den tilsvarende information for et
\emph{forældet} dokument ser det således ud:\\
760 DoD standard Internet Protocol. J. Postel. Jan-01-1980. (Format:
TXT=81507 bytes) (Obsoletes IEN 123) (Obsoleted by RFC0791) (Updated
by RFC0777) (Status: UNKNOWN)


\chapter*{\color{titlecolor}Hardware og netværk til øvelserne}
%\markboth{Hardware og netværk til øvelserne}{}

I dette afsnit beskrives de krav der stilles til miljøet hvor de
beskrevne øvelser kan udføres.

Forudsætningerne for øvelserne er et lokale med et antal PC'er
med Microsoft Windows klienter og netværksadgang.

En del af øvelserne udføres med UNIX, specifikt med OpenBSD, dette
valg er udfra en betragtning om at det er meget stabilt og
understøtter de funktioner godt som beskrives i kurset.

OpenBSD er et moderne operativsystem som er frit tilgængeligt og fordi
det er Open Source tillader det at man kan undersøge og tilpasse
systemet. Man kan endda benytte BSD systemerne kommercielt - hvis man
ønsker det.

Hvis der er mulighed for det kan man installere en anden UNIX variant,
ellers skal der som minimum være adgang til en 
maskine som flere brugere deler:
\begin{itemize}
\item Et flerbruger UNIX system som eksempelvis kan være OpenBSD
\item et udvalg af editorer - så folk føler sig hjemme, EMACS, VI,
  JOVE, Nedit ... I de grafiske brugergrænseflader findes flere
  lettilgængelige  editorer, der som Nedit fungerer med en File ->
  Save menu. 
\item OpenSSH - mulighed for både login og filoverførsel på sikker vis. 
\item webserver med de filer der skal bruges 
\item hubs, switches, netkort - alt efter hvor komplekst et setup der
  vil arbejdes med
\end{itemize}

Et antal windows programmer stilles til rådighed via webserveren:
\begin{itemize}
\item putty - SSH adgang fra Windows
\item winscp - nem adgang til filoverførsel via SSH indeholder tillige editor
\item wireshark - open source pakkesniffer  
\end{itemize}


Formålet med kurset er blandt andet at forstå hvad der sker i netværk
og derfor introduceres emnerne ved hjælp af konfigurationsfiler og
lavniveau beskrivelse af emnet.

Konfigurationsfilerne er ofte mere kompakte og tydelige end
tilsvarende screen-dumps fra GUI programmer.

Tilsvarende implementerer GUI programmerne ikke altid alle dele af de
underliggende lag - og er derfor ikke komplette. Eksempelvis
indeholder firewall funktionen på Mac OS X ingen information om TCP og
UDP eller forskellen på disse.

Alle filer er tilgængelige både på den lokale server i kursuslokalet
og via Internet. På kurset gives anvisninger til adgangen.


Alle filer er tilgængelige både på den lokale server i kursuslokalet
og via Internet. På kurset gives anvisninger til adgangen.





\chapter*{\color{titlecolor}Indholdet i øvelserne}
\markboth{Indholdet i øvelserne}{}

De fleste af øvelserne har følgende indhold:
\begin{itemize}
\item {\bfseries Opgave:} Hvad går øvelsen ud på
\item {\bfseries Formål:} Hvad forventes det at man lærer ved at løse opgaven
\item {\bfseries Forslag til fremgangsmåde:} er en hjælp til at komme igang
\item {\bfseries Hjælp:} et eller flere tips eller beskrivelser af hvordan
  man kan løse opgaven 
\item {\bfseries Forslag til løsning:} en mulig løsning til opgaven
\item {\bfseries Diskussion:} er oplæg til diskussion efter løsning af
  opgaven. Der er mulighed for at sammenligne og diskutere de valgte
  løsninger.
\end{itemize}


\chapter{Putty installation - Secure Shell login}
\label{ex:putty-install}
\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Installer Putty lokalt på jeres arbejdsstation


{\bfseries Øvelse:}\\ 
Installer Putty lokalt på Windows maskinen

{\bfseries Forslag til fremgangsmåde:}\\
Hent og installer programmet, hent fra webserveren eller\\
\link{http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html}


{\bfseries Hjælp:}\\ 
Putty er en terminal emulator og erstatter telnet programmet i
Windows. Det er ofte den foretrukne brugergrænseflade for UNIX brugere
og hackere. Husk at putty skal have at vide at det er SSH protokollen og ikke
Telnet

Hvis der skal ændres på profiler kan Putty godt drille lidt, husk
altid at trykke \verb+Save+ i profilvinduet - så indstillingerne du har
valgt gemmes til næste gang

{\bfseries Forslag til løsning:}\\
Hvis man kender SSH i forvejen anbefales det at man ser på
brug af public key autentifikation herunder nøglegenerering og
installation.

{\bfseries Diskussion:}\\
SSH protokollen tillader både login og filoverførsel - secure copy

Man BØR bruge SSH protokol version 2!

{\bf NB: benyt gerne chancen til at skrive IP-adresser ind i hosts
filen lokalt på din maskine}.

Eksempel:
\begin{alltt}
10.0.45.36    fiona
\end{alltt}

Det gør det nemmere senere at skrive \verb+ping fiona+ for at se om
der er forbindelse til serveren.


\chapter{WinSCP installation - Secure Copy}
\label{ex:winscp-install}

{\bfseries Opgave:}\\
Installer WinSCP lokalt på Windows maskinen

{\bfseries Forslag til fremgangsmåde:}\\ 
Hent og installer programmet, hent winscp fra webserveren eller fra\\
\link{http://winscp.sourceforge.net}

Installer programmet som beskrevet

{\bfseries Hjælp:}\\
WinSCP kan være en stor hjælp når I skal arbejde med filer på UNIX
systemet - I kan ofte slippe for UNIX editorerne VI og EMACS

{\bfseries Diskussion:}\\ 
Kan WinSCP bruges generelt til opdatering af websites? hvad kræver
det? kan brugerne finde ud af det?

WinSCP indeholder også en editor, så vi slipper for Unix VI editor ;-)

\chapter{Login på UNIX systemerne}
\label{ex:unix-login}

{\bfseries Opgave:}\\
Brug jeres arbejdsplads til at logge ind på serverne 

Det kræves at der er installeret SSH program, eksempelvis Putty fra  
øvelse \ref{ex:putty-install}.

{\bfseries Forslag til fremgangsmåde:}\\
Brug SSH til at logge ind på Fiona eller en anden host i netværket

{\bfseries Hjælp:}\\
Der skal bruges enten Putty på Windows eller ssh programmet på UNIX/boot CD

Med UNIX/boot CD og OpenSSH kan logges ind således:\\
\verb+ssh brugernavn@server -p port+ dvs på fiona:\\
\verb+ssh kursus1@fiona -p 22+

NB: fiona er ikke med i DNS, så brug IP-adressen!

%I kan også logge ind på Fiona som er en OpenBSD server
På kursusservere er brugernavne: kursus1, kursus2, kursus3, op til
kursus10 - allesammen med kodeord \emph{kursus}.


{\bfseries Forslag til løsning:}\\
Start Putty/Boot på CD'en

{\bfseries Diskussion:}\\
Kan boot CD'en bruges til andre formål?

Hvad indeholder CD'en?

{\bfseries Hostoplysninger:}\\

\begin{itemize}
\item I bedes registrere IP-adresserne for maskinerne
\item Filer til installation - installationsprogrammer:\\
http:// \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm /public/windows/
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - Din egen
  arbejdsstation - Windows
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - Fiona
  OpenBSD scanserver, nmap mv.
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - 
%\item Fiona maskinen benyttes med SSH til {\bf port 22781}!
\item Til mange opgaver er det nødvendigt med superbruger privilegier
  - root 
\item Skift til root med kommandoen: \verb+sudo -s+ - hvorefter jeres
  prompt ændres til en have låge \verb+#+
\end{itemize}



\chapter{Føling med UNIX}
\label{ex:unix-cal}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Brug manualsiderne til at besvare følgende spørgsmål:

\begin{list2}
\item Hvad er \verb+cal+? Hvad skete der i september 1752?
\item Hvad er \verb+date+?
\item Hvad gør \verb+clear+?
\item Hvad gør \verb+echo+?
\end{list2}

{\bfseries Forslag til fremgangsmåde:}\\ 
Log ind på systemet og udfør opgaven fra kommandolinien.

Du kan enten skrive \verb+man cal+, \verb+man date+, \verb+man clear+,
\verb+man echo+ eller måske blot prøve at skrive kommandoerne

\begin{alltt}
$ date
...
$ cal
...
$ cal 2007
...
$ cal 1752
... osv. - output er skjult med vilje i ovenstående :-)
\end{alltt}

{\bfseries Hjælp:}\\
I denne opgave er det ligegyldigt hvilken server der vælges.
Manualsystemet bruger ofte programmet \verb+less+ til at vise manualsiderne
- dette program bruger / til at søge med. Tryk / og skriv et søgeord
og tryk enter.

Du kan søge baglæns med spørgsmålstegnet.

{\bfseries Forslag til løsning:}\\
Skriv \verb+man cal+ og søg efter 1752 med /

{\bfseries Diskussion:}\\
Søgning med / og ? er ofte benyttet i UNIX programmer, eksempelvis
manualsystemet.

\chapter{UNIX - adgang til root}
\label{ex:sudo}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Hvad er forskellen mellem switch user \verb+su -+ og superuser do
\verb+sudo -+ ? 

{\bfseries Forslag til fremgangsmåde:}\\ 
Brug manualsiderne til at besvare følgende spørgsmål:
\begin{list2}
\item Hvad er forskellen på \verb+su -+ og \verb+sudo -s+?
\item Kan su konfigures til ikke at kræve kodeord? kan sudo?
\item Hvilket kodeord skal man bruge til de to kommandoer?
\end{list2}

{\bfseries Hjælp:}\\
Switch user er den gamle og kendte kommando til at skifte til en anden
bruger, hvis man kender pågældende brugers kodeord.

Superuser do er en mere moderne måde at skifte bruger, eller udføre
administrationskommandoer på UNIX. SUDO tillader at man bruger sit
eget kodeord, kodeord for brugeren man vil skifte til eller man kan
konfigurere den til ikke at kræve kodeord.

Su giver altid fuld adgang og man skal give root kodeord til alle.

Sudo giver fintmasket adgang til at udføre enkelte
kommandoer. Eksempelvis vil en webadministrator kunne få lov til at
genstarte Apache, men ellers ikke andet som root.

{\bf Diskussion:}\\
Sudo benyttes næsten alle steder og betragtes som de facto
standarden. Nogle steder og på egne servere/workstations benyttes den
ofte uden password - er det fornuftigt?



Vi skal bruge root adgang til at læse konfigurationsfiler til services
og genstarte services. Pas på når I kører som root, log evt. ind som kursusbruger altid og skift kun til root med \verb+sudo kommando+ - så går det ikke helt galt :-)

Eksempel kommando med sudo:
\begin{alltt}    
\small
hlk@bigfoot:hlk$ sudo apachectl configtest
Syntax OK
hlk@bigfoot:hlk$ sudo apachectl restart    
hlk@bigfoot:hlk$ 
\end{alltt}

(Bemærk også at Unix ikke fortæller ret meget når ting går godt)


\chapter{UNIX boot CD}
\label{ex:unix-boot-cd}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Boot en PC med en UNIX boot CD

{\bfseries Forslag til fremgangsmåde:}\\ 
Brug den udleverede CD i en PC, eller vi gør det fælles 

{\bfseries Hjælp:}\\
Der findes et stort antal boot CD'er baseret på Linux til forskellige
formål. Nogle af de mest kendte er:
\begin{itemize}
\item Knoppix som er beregnet til almindeligt arbejde, surfing på net,
  Open Office skrivearbejde, E-mail med videre
\item Auditor Security Collection, nu BackTrack - en større
  samling af sikkerhedsbærktøjer til penetrationstest
\item Damn Vulnerable Linux, en usikker Linux distribution, hvor man
  kan lære om sikkerhedsproblemer i software
\end{itemize}

{\bf Diskussion:}\\
Til mange af CD'erne er der nogle boot koder som indimellem er
nødvendige - typisk for at vælge opløsning for det grafiske
miljø. Hvis CD'en ikke virker i en bestemt maskine kan det være
nødvendigt at prøve i en mere standard maskine.

Typisk er det fordi producenterne af trådløse netkort og grafikkort
ikke vil oplyse specifikationerne og instruktionerne til at
programmere enheden.

Specielt hvis man ønsker at bruge trådløse værktøjer fra BackTrack2
CD'en kan det være en fordel at indkøbe specielle netkort. Kort
baseret på Atheros chipset plejer at virke fint.

\chapter{Basale UNIX kommandoer}
\label{ex:unix-basic-commands}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\
Brug manualsiderne til at besvare følgende spørgsmål:

\begin{list2}
\item Hvad er \verb+who+ og \verb+w+ kommandoerne til?
\item Hvad viser \verb+which+ kommandoen, eksempelvis \verb+which cc+?
\item Hvad er \verb+cat+?
\item Hvad er forskellen på \verb+more+ og \verb+less+?
\end{list2}

{\bfseries Forslag til fremgangsmåde:}\\ 
Log ind på systemet og udfør opgaven fra kommandolinien

{\bfseries Hjælp:}\\
Programmet \verb+less+ er en efterfølger til \verb+more+ 
\emph{less is more} 





\chapter{Netværksinformation: ifconfig}
\label{ex:network-ifconfig}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\ 
Brug ifconfig til at indsamle information

{\bfseries Forslag til fremgangsmåde:}\\
Udfør kommandoen \verb+ifconfig -a+ på systemerne og
se information om netværkskort.

{\bfseries Hjælp:}\\ 
Hvad er forskellen på\\
\verb+ifconfig -a+ og \verb+ifconfig vr0+ (Linux: \verb+ifconfig eth0+)

{\bfseries Diskussion:}\\ 
Udover ifconfig og netstat der altid findes på UNIX kan det være en
fordel at installere list open files kommandoen, \verb+lsof+. Med
denne kommando kan man se hvilke programmer der benytter hvilke filer,
herunder netværksforbindelser.

Bemærk: på Linux kaldes netværkskort for eth0, eth1, ... mens OpenBSD
bruger interfacenavne svarende til den driver/hardware som benyttes
nfe0, vr0, em0 osv. Mac OS X og AIX bruger en0, en1, ...

Vores systemer Fiona, Luffe og Biance benytter allesammen VIA Rhine kort.
Soekris 4801 systemer benytter sis driver, så netkort hedder sis0, sis1 og sis2

Timon benytter Intel gigabit netkort som kaldes em0, Atheros baserede netkort til 802.11b/g kaldes typisk for ath0, ath1 osv.

AIX og Mac OS X kalder netkortene for en0, en1 - Mac OS X gør det endda for wireless kort.

Windows kalder kommandoen ifconfig for \verb+ipconfig+ eller \verb+ipv6+ hvis det er information omkring IPv6.

Forvirret? :-)

Brug altid først \verb+ifconfig -a+ evt. \verb+ifconfig -a | more+



\chapter{Netværksinformation: netstat}
\label{ex:network-netstat}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\ 
Brug netstat til at indsamle information

{\bfseries Forslag til fremgangsmåde:}\\
Udfør kommandoerne \verb+netstat+ på systemerne og
se information om netværkskort, lyttende serverprogrammer og
igangværende forbindelser. 

{\bfseries Hjælp:}\\ 
Hvad er forskellen på\\
\verb+netstat -an+ og \verb+netstat -a+

Netstat har mange options, men den mest benyttede er:\\
\verb+netstat -an+ evt. kombineret med grep\\
\verb+netstat -an | grep -i listen+

Netstat kan også vise memoryforbrug og interfacestatistik med -m og -i
options. 

Routingtabellen vises med \verb+netstat -rn+ evt. \verb+netstat -rn -f inet+
eller \verb+netstat -rn -f inet6+


{\bfseries Diskussion:}\\ 
Udover ifconfig og netstat der altid findes på UNIX kan det være en
fordel at installere list open files kommandoen, \verb+lsof+. Med
denne kommando kan man se hvilke programmer der benytter hvilke filer,
herunder netværksforbindelser.

\chapter{Netværksinformation: lsof}
\label{ex:network-lsof}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\ 
Brug lsof til at indsamle information

{\bfseries Forslag til fremgangsmåde:}\\
Udfør kommandoen \verb+lsof+ på systemerne og
se information om lyttende serverprogrammer og
igangværende forbindelser. 

{\bfseries Hjælp:}\\ 
Hvad er forskellen på\\
\verb+lsof+ og \verb+lsof+

LSOF har mange options, men den mest benyttede er:\\
\verb+lsof -n -P+ evt. kombineret med grep\\
\verb+lsof -n -P | egrep -i "..."+

Netstat kan vise mange ting som har med filer at gøre, og alt er jo
filer på UNIX.

{\bfseries Diskussion:}\\ 
Selvom lsof ikke findes som default på UNIX kan det godt betale sig at
benytte denne, ligesom eksempelvis fport på Windows giver den
yderst detaljeret information om systemerne.







\chapter{Opslag i whois databaser}
\label{ex:whois}


{\bfseries Opgave:} \\
Lær at bruge whois 

{\bfseries Forslag til fremgangsmåde:}\\
\begin{list2}
\item Login på UNIX server - læs manualen til programmet whois
eller brug webinterface på\\ \link{http://www.ripe.net}
\end{list2}

{\bfseries Hjælp:}\\ 
Whois databaserne er fordelt på ARIN, RIPE, LACNIC og APNIC.

Kommandoen \verb+whois -r 90.184.69.97+ vil på en OpenBSD give
svaret på et opslag i RIPE databasen efter IP adresse 90.184.69.97

{\bfseries Diskussion:}\\
I skal lære at spørge efter IP adresser og spore oprindelsen - find
eksempelvis brugeren af IP-adressen 217.157.20.129



\chapter{ping og traceroute}
\label{ex:ping}

{\bfseries Opgave:}\\ 
Lær at bruge ping og traceroute programmerne

{\bfseries Forslag til fremgangsmåde:} \\
Brug \verb+ping+ og \verb+traceroute+ til at teste netværksforbindelsen - kan
udføres fra både windows og UNIX.

Husk at traceroute hedder \verb+tracert+ på windows.

Er der forbindelse til alle servere på oversigtstegningen?

{\bfseries Hjælp:} \\
ICMP er Internet Control Message Protocol det bruges typisk til at
rapportere om fejl, host unreachable og lignende.

Ping programmet benytter ICMP ECHO request og forventer ICMP ECHO
reply. Traceroute programmet sender ICMP eller UDP og forventer ICMP
svar tilbage for at kunne mappe et netværk.

{\bf Ekstra:}
Hvad er forskellen på (skal udføres på OpenBSD/UNIX)
\begin{list2}
\item {\bfseries traceroute} og {\bfseries traceroute -I} 
\item NB: traceroute med -I findes kun på UNIX - traceroute med ICMP pakker
\item Der er mange der ikke blokerer for ICMP traceroute
\end{list2}

\chapter{ICMP tool - icmpush}
\label{ex:icmpush}

{\bfseries Opgave:} \\
Lær at bruge icmpush programmet

{\bfseries Forslag til fremgangsmåde:} \\
Login på UNIX server - læs manualen til programmet

{\bfseries Hjælp:} \\
ICMP er Internet Control Message Protocol det bruges typisk til at
rapportere om fejl, host unreachable og lignende.

Ping programmet benytter ICMP ECHO request og forventer ICMP ECHO
reply. Traceroute programmet sender ICMP eller UDP og forventer ICMP
svar tilbage for at kunne mappe et netværk.

{\bfseries Diskussion:}\\ 
I skal lære at spørge efter mindst echo, time og netmask med icmpush


\chapter{DNS og navneopslag}
\label{ex:basic-dns-lookup}

{\bfseries Opgave:}\\
Prøv forskellige programmer til at spørge en service

{\bfseries Forslag til fremgangsmåde:}\\
\begin{itemize}
\item nslookup - findes både på UNIX og Windows
\item Prøv nslookup -q=txt -class=CHAOS version.bind. 0  
\item dig - syntaks @server domain query-type query-class
\item host - syntaks host [-l] [-v] [-w] [-r] [-d] [-t querytype] [-a] host [server]
\item prøv {\bfseries host -a security6.net} \\
{\bfseries host -a www.security6.net} - hvad er forskellen 
\end{itemize}

{\bfseries Hjælp:}\\ 
Host programmet er med som standard på OpenBSD - så brug Fiona eller Luffe

På Unix Boot CD og MS Windows platformen findes mange GUI programmer til det samme.

{\bfseries Diskussion:}\\
Hvad er en zonetransfer? det er alle de records der er defineret for
et domæne

Hvad er forward og reverse lookup? forward er fra hostnavn til IP adresse,
mens reverse er fra IP adresse til hostnavn 




\chapter{ping6 og traceroute6}
\label{ex:ping6}

{\bfseries Opgave:}\\ 
Lær at bruge ping og traceroute programmerne - men med IPv6

{\bfseries Forslag til fremgangsmåde:} \\
Brug \verb+ping6+ og \verb+traceroute6+ til at teste netværksforbindelsen - kan
udføres fra både windows og UNIX.

Husk at traceroute hedder \verb+tracert6+ på windows.

Er der forbindelse til alle servere på oversigtstegningen?

{\bfseries Hjælp:} \\
ICMP er Internet Control Message Protocol det bruges typisk til at
rapportere om fejl, host unreachable og lignende. IPv6 har tilsvarende ICMPv6 med samme funktioner - men har overtaget ARP funktionen.

Ping programmet benytter ICMP ECHO request og forventer ICMP ECHO
reply. Traceroute programmet sender ICMP eller UDP og forventer ICMP
svar tilbage for at kunne mappe et netværk.

{\bf Ekstra:}
Hvad er forskellen på (skal udføres på OpenBSD/UNIX)
\begin{list2}
\item {\bfseries traceroute} og {\bfseries traceroute -I} 
\item NB: traceroute med -I findes kun på UNIX - traceroute med ICMP pakker
\item Der er mange der ikke blokerer for ICMP traceroute
\end{list2}

Det er ikke altid at IPv4 og IPv6 routes går gennem de samme routere! Det er med vilje lavet simpelt i vores setup.

\chapter{DNS og navneopslag - IPv6}
\label{ex:basic-dns-lookup6}

{\bfseries Opgave:}\\
Prøv host programmet til at spørge efter Quad-A (AAAA) records.

{\bfseries Forslag til fremgangsmåde:}\\
\begin{itemize}
\item host - syntaks host [-l] [-v] [-w] [-r] [-d] [-t querytype] [-a] host [server]
\item prøv {\bfseries host -t A security6.net} \\
{\bfseries host -t AAAA security6.net} - hvad er forskellen 
\end{itemize}

{\bfseries Hjælp:}\\ 
Host programmet er med som standard på OpenBSD - så brug Fiona eller Luffe

På Unix Boot CD og MS Windows platformen findes mange GUI programmer til det samme.

{\bfseries Diskussion:}\\
DNS har mange recordtyper og AAAA er blot endnu en. Typisk vil programmer der har IPv6 funktionalitet forsøge at slå både AAAA records og A records op - og forsøge at forbinde til AAAA først.

\chapter{Netværksinformation: sysctl}
\label{ex:sysctl}
%\hlkimage{6cm}{images/putty-1.jpg}

{\bfseries Opgave:}\\ 
Brug sysctl kommandoen til at indsamle information

{\bfseries Forslag til fremgangsmåde:}\\
Udfør kommandoen \verb+sysctl -a | grep net+ på systemerne og
se information om IP-stakken på systemet.

{\bfseries Hjælp:}\\ 

Sysctl giver adgang til mange informationer:\\
\verb+net.inet.ip.forwarding+\\
\verb+net.inet6.ip6.forwarding+\\

Netstat kan også vise memoryforbrug og interfacestatistik med -m og -i
options. 

{\bfseries Diskussion:}\\ 
Udover ifconfig og netstat der altid findes på UNIX kan det være en
fordel at installere list open files kommandoen, \verb+lsof+. Med
denne kommando kan man se hvilke programmer der benytter hvilke filer,
herunder netværksforbindelser.



\chapter{Performance tool - iperf}
\label{ex:iperf}

{\bfseries Opgave:} \\
Lær at bruge iperf programmet

{\bfseries Forslag til fremgangsmåde:} \\
Login på UNIX server - læs manualen til programmet

{\bfseries Hjælp:} \\
Iperf er et lille nemt program som blot skal startes som server på en maskine og derefter kaldes som klient på et andet. Så måler den som default et kort stykke tid og præsenterer resultatet.

{\bfseries Diskussion:}\\ 
Til rigtige performancemålinger er det uhensigtsmæssigt at netværket benyttes til anden traffik under målingerne, medmindre man ønsker at måle nu og her.



\chapter{Afprøv Apache Benchmark programmet}
\label{ex:apache-benchmark}

{\bfseries Opgave:}\\
Afprøv ApacheBench programmet

{\bfseries Forslag til fremgangsmåde:}\\ 
Prøv at køre med 100 eller 1000 forespørgsler på en fil/url

{\bfseries Hjælp:}\\
Prøv \verb+ab -n 100 http://kursus1.pentest.dk/+


{\bfseries Diskussion:}\\ 
Hvornår vil det være relevant at bruge ApacheBench?

\chapter{TCP/IP og sniffere}
\label{ex:wireshark}

\hlkimage{9cm}{images/ethereal-main-window.pdf}

{\bfseries Opgave:}\\
Prøv en Wireshark sniffer på din maskine!

Brug lidt tid på at lære den at kende. 

{\bfseries Forslag til fremgangsmåde:}\\
Find Wireshark og installer denne, hent fra den lokale webserver eller \link{http://www.wireshark.org}

{\bfseries Hjælp:}\\
Find ud af hvordan det er understøttet i dit favorit operativsystem
ved at bruge eksempelvis \link{http://www.google.com}

{\bfseries Forslag til løsning:}\\
Windows - hvis du er på Windows skal der
installeres WinPCAP - packet capture - biblioteket. Dette kan
eksempelvis hentes på den lokale webserver. I nyere versioner af
Wireshark følger dette med i installationsfilen.

%adressen:
%\href{http://www.security6.net/courses/programs/WinPcap_3_0_beta.exe}
%{http://www.security6.net/courses/programs/WinPcap\_3\_0\_beta.exe}

UNIX - de fleste UNIX varianter har installationspakker til Wireshark
og TCPdump

Prøv efter installationen at kigge på den normale trafik på nettet,
eller generer selv trafik med ping og traceroute (windows: tracert)
programmer 
- når dette er gjort virker snifferen

{\bfseries Diskussion:}\\
Kender du forskel på ICMP, TCP og UDP? Prøv at skrive 
\verb+icmpush -h+ mens du er logget ind på kursusserveren -
senere. Hvad er det for et program? 

Hvilke protokoller bruger kryptering?

Husk også at sniffe en TCP session og sammensæt alle pakkerne med
TCP Follow Stream funktionaliteten.

Wireshark er en efterfølger til Ethereal, navneskiftet skyldes et jobskifte hvor ejeren af Ethereal domænet ikke ville give det med programmøren.



\chapter{Logning med syslogd og syslog.conf}
\label{ex:syslogd-basic}

{\bfseries Opgave:}\\
log ind på et OpenBSD UNIX system og se på \verb+syslog.conf+

{\bfseries Forslag til fremgangsmåde:}\\
\begin{list2}
\item Hvor ligger den? - i hvilket katalog?
\item Hvordan kan man sende loggen videre til en anden maskine?
\item Hvilken protocol og port bruger syslog - hvis I skal tillade det
  gennem en firewall?
\end{list2}

{\bfseries Hjælp:}\\
 Indholdet af filen kan ses på næste slide

\begin{alltt}
\small
*.err;kern.debug;auth.notice;authpriv.none;mail.crit    /dev/console
*.notice;auth,authpriv,cron,ftp,kern,lpr,mail,user.none /var/log/messages
kern.debug;user.info;syslog.info                        /var/log/messages
auth.info                                               /var/log/authlog
authpriv.debug                                          /var/log/secure
...
# Uncomment to log to a central host named "loghost".
#*.notice;auth,authpriv,cron,ftp,kern,lpr,mail,user.none        @loghost
#kern.debug,user.info,syslog.info                               @loghost
#auth.info,authpriv.debug,daemon.info                           @loghost
\end{alltt}

{\bfseries Diskussion:}\\
Se også \link{http://www.loganalysis.org/}





\chapter{SNMP walk}
\label{ex:snmpwalk}

{\bfseries Opgave:}\\
Log ind på et OpenBSD UNIX system og se på \verb+snmpwalk+

{\bfseries Forslag til fremgangsmåde:}\\
SNMP walk betyder at man går igennem alle SNMP oplysningerne fra et system.

{\bfseries Hjælp:}\\
\verb+snmpwalk -v 2c -c public system+

Public er default på meget udstyr og findes stadig mange steder i produktion.

Private er et andet kendt community name og gav tidligere lov til at ændre indstillingerne på enheder.

{\bfseries Diskussion:}\\



\chapter{AirPort Extreme}
\label{ex:AirPort-AP}

{\bfseries Opgave:}\\
Konfiguration af Apple AirPort Extreme

{\bfseries Forslag til fremgangsmåde:}\\
Hent AirPort konfigurationsprogrammet til Windows og
brug denne til at konfigurere Apple AirPort

{\bfseries Hjælp:}\\
Manualen til udstyret forefindes i PDF format

{\bfseries Forslag til løsning:}\\
Sæt det trådløse udstyr i et isoleret netværk når det skal konfigureres

{\bfseries Diskussion:}\\
Hvad er de to LAN stik til? - begge er jo Ethernet?

Sørg for at undersøge alle mulighederne i konfigurationen



\chapter{Wardriving på Windows - netstumbler}
\label{ex:wardriving-windows}

{\bfseries Opgave:}\\
Installer netstumbler på en Windows laptop - og lav wardriving

Kræver I har et netkort der er understøttet

{\bfseries Forslag til fremgangsmåde:}\\
Med netstumbler(windows), Kismet(unix) og iStumbler kan man
scanne efter trådløse netværk med almindeligt trådløst udstyr

{\bfseries Hjælp:}\\

{\bfseries Forslag til løsning:}\\

{\bfseries Diskussion:}\\
Er det lovligt?

Hvorfor er der så mange åbne netværk?


\chapter{Wardriving på UNIX - Kismet}
\label{ex:wardriving-kismet}

{\bfseries Opgave:}\\
Afprøv Kismet laptoppen - og lav wardriving

Kræver I har et netkort der er understøttet af Boot CD/Linux

{\bfseries Forslag til fremgangsmåde:}\\
I skal blot se hvorledes wardriving tager sig ud på UNIX - kende
programmerne 

{\bfseries Hjælp:}\\

{\bfseries Forslag til løsning:}\\
I skal være velkomne til at undersøge hvordan Kismet installeres

{\bfseries Diskussion:}\\
Der findes ``stumbler'' programmer til de mest benyttede platforme,
men hvilke kort understøttes!

Det kan ofte være en god ide at undersøge om det kort man vil købe kan
bruges til at wardrive - idet wardriving er vigtigt internt i
virksomhederne for at finde uautoriserede (engelsk: rogue) access
points. 





\chapter{BIND version}
\label{ex:bind-version}

{\bfseries Opgave:} \\
Find version på BIND software på UNIX

{\bfseries Forslag til fremgangsmåde:}\\ 
Brug en af følgende kommandoer til at finde version på BIND på
navneserveren:\\ 

\verb+nslookup -q=txt -class=CHAOS version.bind. 0 server+

\verb+dig @server version.bind chaos txt+


{\bfseries Hjælp:} \\

{\bfseries Diskussion:} \\
BIND softwaren er ofte udsat for angreb

BIND og navnesystemet er kritisk for mange funktioner som web og mail

\chapter{Tilpasning af DNS server}
\label{ex:bind-config}
{\bfseries Opgave:}\\
Konfiguration af en BIND ved hjælp af named.conf, men hvordan ser den ud.

{\bfseries Forslag til fremgangsmåde:}\\ 

Log ind på Luffe, som afvikler en rekursiv DNS og Mai som afvikler en autoritativ navneserver.

Begge benytter OpenBSD hvor BIND er installeret med konfiguration og data under \verb+/var/named+. 

\begin{list1}
\item Find ud af - hvad er:
\begin{list2}
\item master server
\item slave server 
\item caching-only server
\end{list2}
\item \verb+/var/named+ kataloget, hint chroot'et installation
\item \verb+/var/named/etc+ - underkataloget, hint konfiguration
\item \verb+/var/named/standard+ - underkataloget, hint localhost
\end{list1}

{\bfseries Hjælp:}\\
BIND er installeret - så find \verb+named.conf+ og læs den

{\bfseries Diskussion:}\\
Det er altid en god ide at en navneserver kan svare på localhost.


\chapter{Vedligehold af DNS systemer}
\label{ex:bind-dnszone}
\hlkimage{8cm}{images/dnszone-logo.png}
{\bfseries Opgave:}\\
Prøv et gratis adminsystem til DNS

{\bfseries Forslag til fremgangsmåde:}\\
Gå ind på \link{http://www.dnszone.org} og prøv demo sitet, eller
se gratisdns interface som instruktøren kan vise.

{\bfseries Hjælp:}\\
Det anbefales KRAFTIGT at man bruger et system til vedligehold af
DNS oplysninger

{\bfseries Diskussion:}\\
Der findes mange programmer og produkter til administration af DNS -
eksemplet ovenfor er kun et af disse.

Når man har konfigureret DNS bør man overveje at finde en service på
nettet der checker konfigurationen, eksempelvis DNS advisor fra 
\link{http://www.infoblox.com} eller \link{http://www.dnsreport.com}.

Husk efter konfiguration af et domæne at checke det med programmer som dem på 
\link{http://www.infoblox.com} eller \link{www.dnsreport.com}


\chapter{Konfiguration af DHCP server}
\label{ex:dhcpd-config}

{\bfseries Opgave:}\\
Konfiguration af en DHCPD foregår ved hjælp af dhcpd.conf

{\bfseries Forslag til fremgangsmåde:}\\ 
Undersøg dhcpd.conf på vores systemer.

{\bfseries Hjælp:}\\
Log ind på systemerne og vis netværkskonfigurationen med \verb+ifconfig+
og dhcpd.conf filen med \verb+cat /etc/dhcpd.conf+ - Luffe er den nemmeste at vælge.

Når dhcpd startes på OpenBSD benyttes tillige \verb+/etc/dhcpd.interfaces+ til at vælge
hvilke netkort der skal svares på DHCP.

\begin{alltt}
#
# DHCP server options.
# See dhcpd.conf(5) and dhcpd(8) for more information.
#
#
shared-network LOCAL-NET {
        option  domain-name "kramse.dk";
        #option  domain-name-servers 192.168.1.3, 192.168.1.5;
        subnet 10.0.45.0 netmask 255.255.255.0 {
                option routers 10.0.45.2;
                range 10.0.45.32 10.0.45.200;
        }
}
\end{alltt}

{\bfseries Diskussion:}\\
Det ville være næsten umuligt for almindelige brugere at benytte en laptop, hvis de manuelt skulle skifte adresse fra netværk til netværk.

Det er ofte set at folk der manuelt sætter en adresse ender med at sætte router adressen på deres netkort, hvad sker der så?




\chapter{Opbygning af Apache httpd.conf}
\label{ex:apache-httpd.conf}

{\bfseries Opgave:}\\
Se på konfigurationsfilen til Apache som hedder \verb+httpd.conf+

{\bfseries Forslag til fremgangsmåde:}\\ 
- den er lang og det er ikke helt trivielt at konfigurere Apache! 

læs lidt i den og prøv at forstå dele af opbygningen

tilpas konfigurationen af webserveren, email adresser, hostnavn mv.

{\bfseries Hjælp:}\\
hint: brug navnet www.pentest.dk til serveren og domænet pentest.dk
til de virtuelle hosts, og sørg for at dette
senere laves i DNS serveren - samt \verb+/etc/hosts+ på systemet!

{\bfseries Diskussion:}\\ 
Husk at gemme en kopi af den oprindelige httpd.conf fil!

Det anbefales at bruge versionsstyring til konfigurationen

\chapter{Apache virtuelle hosts}
\label{ex:apache-virtual}


{\bfseries Opgave:}\\
Se på virtuelle hosts på web serveren

{\bfseries Forslag til fremgangsmåde:}\\ 
Undersøg httpd.conf og tilhørende virtuelle konfiguration


{\bfseries Hjælp:}\\
Oprette evt. kataloger med HTML filerne index.html - med
forskelligt indhold

{\bfseries Diskussion:}\\ 
NB: husk at hostnavnet overføres fra klienten! I skal altså sikre jer
at der står et navn og IP-adresse i /etc/hosts filen på klienten! (på
Windows ligger den typisk under \verb+c:\winnt\system32\drivers\etc\hosts+

Hvis I bruger de forberedte virtuelle hosts, som er oprettet svarende til kursusbrugere
kursus1.pentest.dk burde det virke. Dvs brug navneserveren på netværket gennem DHCP :-)

% mellemting



\chapter{Konfiguration af e-mail server}
\label{ex:email-server-config}

{\bfseries Opgave:}\\
Der skal laves e-mail server baseret på postfix
  som accepterer post til pentest.dk domænet

Valgfrit om man vil lave denne opgave :-)

{\bfseries Forslag til fremgangsmåde:}\\ 
Log ind og udpak postfix kildeteksten i jeres hjemmekatalog. Brug eksempelvis Fiona kursusserveren.

Konfigurer til at installere i jeres hjemmekatalog og skift eventuelt
portnummer - så der ikke kommer konflikt med de andre på holdet

NB: Hvis flere starter server der vil lytte på port 25 giver det
problemer! I kan ændre portnummer i Postfix master.cf - linien der
starter med "smtp" ændres til eksempelvis "2025"


Tip: I kan teste serveren ved at forsøge \emph{telnet localhost
  portnr} og indtaste e-mail direkte

{\bfseries Hjælp:}\\
Test af e-mail server kan udføres med Telnet 

\begin{alltt}
[hlk]$ {\bfseries telnet localhost 2025} 
Connected.
Escape character is '^]'.
220 server ESMTP Postfix
{\bfseries helo test}
250 server
{\bfseries mail from: postmaster@pentest.dk}
250 Ok
{\bfseries rcpt to: root@pentest.dk}
250 Ok
{\bfseries data}
354 End data with <CR><LF>.<CR><LF>
{\bfseries skriv en kort besked}
.
250 Ok: queued as 91AA34D18
{\bfseries quit}
\end{alltt}
%$

{\bfseries Diskussion:}\\
Det er vigtigt at en server kan komme af med beskeder om systemets
tilstand. Husk derfor altid at sikre at der kører en postserver -
eventuelt den medfølgende Sendmail.

Til servere der skal modtage post og sende det videre anbefales
Postfix - den er nemmere at konfigurere end Sendmail.

Husk også at oprette en fil \verb+.forward+ for brugere, således at
mail ikke strander på servere. Denne fil skal blot indeholde en e-mail
adresse hvor posten skal sendes videre til.



\chapter{RPC info}
\label{ex:unix-rpcinfo}

{\bfseries Opgave:} \\
Find RPC services på UNIX

{\bfseries Forslag til fremgangsmåde:} \\
Brug programmet til at checke om der findes RPC services på vores servere

\verb+rpcinfo -p fiona+

{\bfseries Hjælp:} \\
RPC info programmet kontakter portmapper programmet på den pågældende
server og får en liste over de tilgængelige services

{\bfseries Diskussion:}\\
Bør denne funktion være tilgængelig på produktionsudstyr?

Hvad er ulempen ved services der ikke ligger på faste porte?
(hint: tænk firewalls)

\chapter{NFS info}
\label{ex:unix-nfsinfo}

{\bfseries Opgave:} \\
Find NFS shares på UNIX

{\bfseries Forslag til fremgangsmåde:} \\
Brug kommandoen \verb+showmount -e + til at vise hvilke kataloger der
eksporteres fra en server.

{\bfseries Hjælp:} \\
RPC info programmet kontakter portmapper programmet på den pågældende
server og får en liste over de tilgængelige services. I denne liste over services findes NFS
og med en kommando kan man se hvilke kataloger der eksporteres - og rettigheder.

{\bfseries Diskussion:}\\
Bør denne funktion være tilgængelig på produktionsudstyr?

Hvad er ulempen ved services der er baseret på IP-adresse som sikkerhedsmekanisme.

NFS findes i flere versioner, version 3 er mest udbredt men NFSv4 er på vej og giver
bedre sikkerhed.




\chapter{Firewallkonfiguration}
\label{ex:unix-basic-firewall}

{\bfseries Opgave:}\\
Konfiguration af en firewall - se eksempler, fællesopgave

{\bfseries Forslag til fremgangsmåde:}\\
\begin{list2}
\item Hvordan enabler man firewall?
\item Hvordan åbner man for noget i vores firewall?
\item Tilføj en regel for at tillade adgang til noget mere på vores
  systemer
%\item Gå sammen i hold pr system 
\end{list2}

På OpenBSD kan man se om firewall er enablet med kommandoen \verb+pfctl+. Prøv følgende kommandoer på eksempelvis Luffe
\begin{list2}
\item \verb+sudo pfctl -s all | more+
\item \verb+sudo pfctl -s rules | more+
\item \verb+sudo pfctl -s nat | more+
\item \verb+sudo pfctl -s states | more+
\item \verb+sudo pfctl -s info | more+\\
...
\end{list2}



{\bfseries Hjælp:}\\
Vi gennemgår sammen ændringen på de forskellige firewalls vi har til
rådighed! 

%Hint: se på \verb+/etc/sysconfig/iptables+
%og \verb+system-config-securitylevel+

%NB: Hvis I oplever problemer med Red Hat konfigurationsværktøjerne og
%X kan I lave \verb+unset DISPLAY+ for at tvinge det til tekstmode udgaven.

{\bfseries Diskussion:}\\
Sørg for at Henrik viser flere firewalls!

Der er GUI på Mac OS X, Windows, Linux og også til OpenBSD PF pfw




\chapter{Find maskiner}
\label{ex:nmap-sweep}

{\bfseries Opgave:}\\ 
Log på UNIX og brug nmap til at søge efter maskiner på lokalnetværket som ping sweep eller port sweep

{\bfseries Forslag til fremgangsmåde:}\\ 
Lav forskellige typer scan og
inddel resultaterne efter:
\begin{list2}
\item aktive systemer
\item åbne porte/services
\end{list2}

{\bfseries Hjælp:} \\
Prøv med Nmap sweep:
\begin{list1}
\item \verb+nmap -sP 10.0.45.*+
\item \verb+nmap -p 80 10.0.45.*+
\item Prøv også gerne de andre netværk, .46 .53 osv.
\end{list1}

{\bfseries Diskussion:}\ 
Er det noget som foregår på Internet? Ja, konstant


\chapter{nmap portscanning}
\label{ex:nmap-portscan}

{\bfseries Opgave:} \\
Brug nmap til at finde åbne porte på netværket

{\bfseries Forslag til fremgangsmåde:}\\ 
Brug \verb+nmap -p 1-1024 server+ til at scanne de første 1024 TCP
porte på en server
Brug \verb+nmap -sU+ til at scanne efter UDP porte og \verb+-P0+
option til at undgå at sende ping først

{\bfseries Hjælp:} \\
Eksempel: \verb+nmap -P0 -sU -p1-1024 server+ UDP portscanning af port
1-1024 uden ping først

{\bfseries Diskussion:}\\ 
TCP og UDP portscanning er meget forskelligt. TCP er
forbindelsesorienteret og har session setup i form af en three-way
handshake som gør at en client først sender TCP-SYN, server svarer med 
TCP-SYN+ACK og derefter etableres forbindelsen endeligt med TCP-ACK fra
klienten. UDP er forbindelsesløs kommunikation og der er ingen session
setup - derfor er UDP scanning mere upålideligt.

\chapter{nmap servicescanning}
\label{ex:nmap-service}

{\bfseries Opgave:} \\
Brug nmap service detection til at finde ud af hvilke services der
gemmes sig bagved de åbne porte på netværket

{\bfseries Forslag til fremgangsmåde:}\\ 
Brug \verb+nmap -A+ option til at slå service detection til

{\bfseries Hjælp:} \\
Kig på manual siden til nmap

{\bfseries Diskussion:}\\ 
Hvordan finder man ud af hvilken protokol der ligger bagved en port?


\chapter{nmap OS detection}
\label{ex:nmap-os}

{\bfseries Opgave:} \\
Brug nmap OS detection til at finde operativsystemerne på netværket

{\bfseries Forslag til fremgangsmåde:}\\ 
Find listen med aktive systemer fra tidligere (eller lav sweeps)
kig på manualsiderne {\bfseries man nmap} 
udfør OS detection på de fundne maskiner

{\bfseries Hjælp:} \\
Brug \verb+nmap -O+ option til at slå OS detection til

Nmap portscanneren kan sende specielle pakker og dermed udlede hvilket
operativsystem der gemmer sig - udfra de svar der kommer retur
 
{\bfseries Diskussion:}\\ 
Nmap OS detection er ikke altid lige præcis - det hjælper hvis der
angives både en åben og en lukket port - hvorfor?
og {\bfseries man xprobe}




\chapter{Chroot af BIND}
\label{ex:bind-chroot}


{\bfseries Opgave:}\\
Hvad er chroot af BIND, forstå konceptet af adskillelse

{\bfseries Forslag til fremgangsmåde:}\\ 
\begin{list1}
\item find mindst en beskrivelse af hvordan man chroot'er BIND
\item valgfrit om I finder beskrivelsen til:
  \begin{list2}
    \item Linux
\item OpenBSD
\item eller andre UNIX systemer
  \end{list2}
\item Læs den og prøv at forstå den
\end{list1}

{\bfseries Hjælp:}\\
Chroot giver en god ekstra sikkerhed med services som BIND!

{\bfseries Diskussion:}\\
Både Solaris og FreeBSD giver med zones og jail flere muligheder for
at styre og kontrollere serverprogrammer.



\appendix 
\rhead{\fancyplain{}{\bfseries\leftmark}}
%\setlength{\parskip}{5pt}
\normal

\chapter{OpenSSH template}

Her præsenteres en konfigurationsfil til OpenSSH
serveren. Konfigurationen er forsøgt tilpasset til produktionsbrug i
enterprisemiljøer.

Filen kan findes og downloades via internetadressen:\\
\url{http://www.kramse.dk/projects/unix/opensshtemplate_en.html}



\VerbatimInput{files/sshd_config.template}



\chapter{Start-stop script til services}

Mange applikationer inkluderer egne start-stop scripts, men hvis de
ikke gør er nedenstående en mulighed for at lave sit eget.

Scriptet kan eksempelvis udføres under boot eller via alias:
\begin{alltt}
\small
alias tomcat=' sudo -u tomcat /userdata/tomcat/bin/tomcat'
\end{alltt}

\VerbatimInput{files/tomcat}

\chapter{Korn shell login-profil }

Det er vigtigt at man bruger tid på at indstille sin shell efter egne
ønsker og behov.

Nedenfor findes en .profile der kan benyttes med Korn Shell - NB:
denne er beregnet til brug med pdksh, som er public domain Korn Shell.

%\begin{alltt}
%\small
\VerbatimInput{files/profile}
%\end{alltt}



\chapter{Hostoplysninger}

\begin{itemize}
\item I bedes registrere IP-adresserne for maskinerne
\item Filer til installation - installationsprogrammer:\\
http:// \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm
/public/windows/ - webserver med diverse tools
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - Fiona
\item Fiona maskinen benyttes med SSH til {\bf port 22781}!
\item Kursus login brugernavne: kursus1, kursus2, ... kursus10
kodeord: \verb+kursus+ - uanset brugernavn
\item Skift til root med: \verb+sudo -s+
\end{itemize}

\section*{Vores maskiner}
\begin{itemize}
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - 
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - 
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - 
  OpenBSD
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - 
  OpenBSD scanserver
\item IP: \hskip 15mm .\hskip 15mm .\hskip 15mm .\hskip 15mm - Din egen
  arbejdsstation - Windows/Linux
\end{itemize}



% der er ikke lavet ordliste til forensics workshop
%\chapter{Ordliste og forklaringer}
%\label{app:ordliste}
%\input{../ipv6-reference/wordlist.dk.tex}


%\chapter{Sikkerhed}

%Når man aktiverer \emne åbner man mange muligheder for angreb!

%Det vil ofte være muligt at skabe adgang til netværket for
%uvedkommende og det er derfor nødvendigt med løbende kontrol,
%overvågning og udskiftning af hemmeligheder som kodeord.

%IPsec er et krav til alle IPv6 implementationer, så man ved at man har
%muligheden for at kommunikere sikkert.

%Wireless teknologier og IPv6 er blot to emner der har indflydelse på
%sikkerheden i dagens netværk - men ofte kan det integreres fornuftigt
%med både virksomheden og de netværk som skal forbindes til
%infrastrukturen. 

%Det anbefales at læse bogen: \title{Firewalls and {Internet} Security:
%  Repelling the Wily Hacker}, \cite{Cheswick:2003:FIS}


\bibliographystyle{alpha}
%\bibliography{../ipv6-reference/security6-net.bib,../ipv6-reference/rfc.bib,../ipv6-reference/std.bib,../ipv6-reference/fyi.bib}
\bibliography{kramse.bib,rfc.bib,std.bib,fyi.bib}
%,internet.bib}


%\printindex

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
